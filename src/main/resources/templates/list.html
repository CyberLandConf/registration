<!DOCTYPE html>
<html>
{{> head }}
<body>
    <div class="container">
    <h2>JUG DA Anmeldungen f√ºr EventId {{ eventId }}: {{ total }}</h2>
    <table class="table table-striped table-condensed">
        <thead>
        <tr>
            <th>Lfd.Nr.</th>
            <th>Name</th>
            <th>E-Mail</th>
            <th>Twitter</th>
            <th>Stammtisch</th>
            <th>Warteliste</th>
            <th>Datum</th>
            <th></th>
        </tr>
        </thead>
        <tbody>
        {{#each registrations}}
            <tr id="{{ id }}">
                <td>{{ @index }}</td>
                <td>{{ name }}</td>
                <td><a href="mailto:{{ email }}">{{ email }}</a></td>
                <td><a href="https://twitter.com/{{ twitter}}" target="_blank">{{ twitter }}</a></td>
                <td>
                    {{#if pub}}<span class="glyphicon glyphicon-ok"></span>{{/if}}
                </td>
                <td>
                    {{#if waitlist}}<span class="glyphicon glyphicon-pushpin"></span>{{/if}}
                </td>
                <td>{{ datetime created }}</td>
                <td><span class="glyphicon glyphicon-trash text-danger" onclick="delReg('{{ id }}', '{{ name }}')" style="cursor: pointer"></span></td>
            </tr>
        {{/each}}
        </tbody>
    </table>
    <div>
        <button class="btn btn-default" data-toggle="collapse" data-target="#collapseEmails">
            Zeige E-Mails in Textfeld
        </button>
        <div class="collapse" id="collapseEmails">
            <textarea class="form-control" rows="5">{{#each registrations}}{{email}}, {{/each}}</textarea>
        </div>
    </div>
    </div>
    <script src="https://code.jquery.com/jquery-2.2.4.min.js"></script>
    <script src="https://www.jug-da.de/js/bootstrap.min.js"></script>
    <script>
        var delReg = function(id, name) {
            if (confirm('Delete registration of ' + name + '?')) {
                console.log('deleting registration', id);
                $.ajax({
                    url: '/delete?id=' + id,
                    type: 'DELETE'
                }).done(function () {
                    $('#' + id).remove();
                });
            }
        }
    </script>
</body>
</html>
